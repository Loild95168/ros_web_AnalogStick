<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>æ§åˆ¶ ROS ç„¡äººè»Š</title>
</head>
<body>
  <h2>é ç«¯æ§åˆ¶ä»‹é¢</h2>

  <div>
    <button onclick="send('forward')">å‰é€²</button>
    <button onclick="send('backward')">å¾Œé€€</button>
    <button onclick="send('stop')">åœæ­¢</button>
  </div>

  <hr>

  <div id="clientTime" style="font-size: 16px; margin-top: 10px;"></div>
  <div id="serverTime" style="font-size: 16px;"></div>
  <div id="delay" style="font-size: 16px;"></div>

  <script>
    function getFormattedTime(date) {
      return date.getFullYear() + '-' +
             String(date.getMonth() + 1).padStart(2, '0') + '-' +
             String(date.getDate()).padStart(2, '0') + ' ' +
             String(date.getHours()).padStart(2, '0') + ':' +
             String(date.getMinutes()).padStart(2, '0') + ':' +
             String(date.getSeconds()).padStart(2, '0') + '.' +
             String(date.getMilliseconds()).padStart(3, '0');
    }

    function send(cmd) {
      const now = new Date();
      const clientTime = now.toISOString();  // é€å‡ºçµ¦ä¼ºæœå™¨ï¼ˆUTCï¼‰
      const localDisplay = getFormattedTime(now);  // é¡¯ç¤ºç”¨ï¼ˆæœ¬åœ°æ™‚é–“ï¼‰

      fetch('https://ros-web-control.onrender.com/control', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ command: cmd, client_time: clientTime })
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById('clientTime').innerText = "ğŸ“² æ‰‹æ©Ÿé€å‡ºæ™‚é–“ï¼š" + localDisplay;
        document.getElementById('serverTime').innerText = "ğŸ•’ å°ç£ä¼ºæœå™¨æ™‚é–“ï¼š" + data.server_time_taiwan;
        document.getElementById('delay').innerText = "â± æŒ‡ä»¤å»¶é²ï¼š" + data.delay_ms + " æ¯«ç§’";
      });
    }
  </script>
</body>
</html>
